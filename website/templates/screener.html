<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Screener</title>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script src="https://cdn.datatables.net/1.11.2/js/jquery.dataTables.min.js"></script>

    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.2/css/jquery.dataTables.min.css">

    <link rel="icon" href="../static/pictures/My%20project%20(1).png">

    <link href="../static/css/screener_style.css" rel="stylesheet">

    <script src="../static/js/screener_script.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <script>
        let count_data = JSON.parse('{{ counts | tojson | safe }}');

        let buyColumns = [3, 4, 5, 6, 7, 8];
        let sellColumns = [9, 10, 11, 12, 13, 14];

        $(document).ready(function () {
            let table = $('#users-table').DataTable({
                "dom": 't p',
                "pageLength": 100,
                scrollY: '700px',
                scrollCollapse: true,
                paging: true,
                data: count_data,
                language:{
                  paginate: {
                      previous: 'Previous',
                      next:     'Next',
                  }
                },
                columnDefs: [
                    {targets: 0, className: 'dt-left dt-bold'}
                ],
                columns: [
                    {
                        data: 'name',
                        visible: true,
                        render: function (data, type, row) {
                            return '<a href="/screener/' + row.tick + '" target="_blank" style="color: black">' + data + '</a>';
                        }
                    },
                    {data: 'tick', visible: true },
                    {data: 'etf', visible: true},
                    {data: 'seq_buy_d', visible: true},
                    {data: 'combo_buy_d', visible: true},
                    {data: 'seq_buy_w', visible: true},
                    {data: 'combo_buy_w', visible: true},
                    {data: 'seq_b_9139', visible: true},
                    {data: 'combo_b_9139', visible: true},
                    {data: 'seq_sell_d', visible: true},
                    {data: 'combo_sell_d', visible: true},
                    {data: 'seq_sell_w', visible: true},
                    {data: 'combo_sell_w', visible: true},
                    {data: 'seq_s_9139', visible: true},
                    {data: 'combo_s_9139', visible: true}
                ]
            });

            $('#toggle-buy-columns').on('change', function () {
                let isVisible = !$(this).is(':checked');

                buyColumns.forEach(function (columnIdx) {
                    table.column(columnIdx).visible(isVisible);
                });

            });

            $('#toggle-sell-columns').on('change', function () {
                let isVisible = !$(this).is(':checked');

                sellColumns.forEach(function (columnIdx) {
                    table.column(columnIdx).visible(isVisible);
                });

            });

            $('#myInput').on('keyup', function () {
                table.column(2).search(this.value).draw();
            });

        });

    </script>

</head>
<body>

<div class="container-fluid" style="padding: 10px">


    <nav class="navbar" style="background-color: rgba(241,241,241,0.40)">
        <div style="background-color: rgba(241,241,241,0.40); display: flex; align-items: center; flex-grow: 1; flex-wrap: wrap">

            <h1 class="navbar-text title"><img src="../static/pictures/My%20project%20(1).png" style="width: 100px; height: 100px;" alt="Logo">  DeMark Screener</h1>

            <div style="display: flex; align-items: center; justify-content: flex-end; flex-grow: 1; gap: 1em">


                <div style="display: flex; align-items: center; justify-content: flex-end; gap: 1em">
                    <input type="checkbox" id="toggle-buy-columns" />Hide Buy Counts<label for="toggle-buy-columns"></label>
                </div>



                <div style="display: flex; align-items: center; justify-content: flex-end; gap: 1em">
                    <input type="checkbox" id="toggle-sell-columns">Hide Sell Counts<label for="toggle-sell-columns"></label>
                </div>



            </div>

            <form autocomplete="off" style="padding-left: 2em; padding-right: 2em">
                    <div class="autocomplete" style="width: 300px; opacity: 0.9; display: flex; justify-items: flex-end">
                        <input id="myInput" type="text" name="myCountry" placeholder="Sector/Country">
                    </div>
            </form>

        </div>
    </nav>


<br>
    <div class="dataTables-container">
        <table id="users-table" class="order-column cell-border display compact">
            <thead>
            <tr>
                <th>Name</th>
                <th>Ticker</th>
                <th>Sector/Country</th>
                <th>Seq Buy Count</th>
                <th>Combo Buy Count</th>
                <th>Seq Buy Weekly</th>
                <th>Combo Buy Weekly</th>
                <th>Seq 9-13-9 Buy</th>
                <th>Combo 9-13-9 Buy</th>
                <th>Seq Sell Count</th>
                <th>Combo Sell Count</th>
                <th>Seq Sell Weekly</th>
                <th>Combo Sell Weekly</th>
                <th>Seq 9-13-9 Sell</th>
                <th>Combo 9-13-9 Sell</th>
            </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

</div>


</body>
</html>




